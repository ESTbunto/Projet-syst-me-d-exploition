#!/bin/bash

# constants
quiz_file=ESTqcm.txt
score=0

# Pour vérifier si le fichier de qcm existe
if [ ! -f $quiz_file ]
then
    echo "Fichier QCM introuvable !"
    exit 1
fi

# game loop (loop over quiz file line/line)
while read -u9 line
do
    # analyse du fichier qcm pour la question en cours
    question=`echo $line | cut -f1 -d' '`
    choice1=`echo $line | cut -f2 -d' '`
    choice2=`echo $line | cut -f3 -d' '`
    choice3=`echo $line | cut -f4 -d' '`
    solution=`echo $line | cut -f5 -d' '`

    # ecrire question et choix
    echo "$question?"
    echo "- $choice1"
    echo "- $choice2"
    echo "- $choice3"

    # Lire le choix
    read -p "- Votre résponse: " player_choice

    # Corriger et compter le score
    if [ "$player_choice" == "$solution" ]
    then
        score=$(( ++score ))
        echo "c'est correcte (^_^)"
    else
        echo "fausse réponse (-_-). La correcte est $solution"
    fi

    echo
done 9< $quiz_file

# afficher le score finale
echo "Votre score est $score/`wc -l $quiz_file`"